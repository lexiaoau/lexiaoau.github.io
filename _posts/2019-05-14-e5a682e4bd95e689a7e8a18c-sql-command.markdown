---
author: lexiao
comments: true
date: 2019-05-14 01:36:35+00:00
layout: post
link: http://localhost/blog/?p=401
slug: '%e5%a6%82%e4%bd%95%e6%89%a7%e8%a1%8c-sql-command'
title: 如何执行 SQL command
wordpress_id: 401
categories:
- SQL Server 和 .NET
---



  1. SqlCommand 类



    1. 重要属性



      1. a 
<table cellpadding="0" border="1" style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; BORDER-LEFT: medium none; BORDER-BOTTOM: medium none; BORDER-COLLAPSE: collapse; mso-table-layout-alt: fixed; mso-border-alt: solid windowtext .5pt; mso-yfti-tbllook: 480; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt; mso-border-insideh: .5pt solid windowtext; mso-border-insidev: .5pt solid windowtext" cellspacing="0" >
<tbody >
<tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt" valign="top" >


**PROPERTY**

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" >


**TYPE**

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt" valign="top" >


**DESCRIPTION**

</td></tr>
<tr style="mso-yfti-irow: 1" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


CommandText

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


string

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


</td></tr>
<tr style="mso-yfti-irow: 2" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


CommandTimeout

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


int

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


命令预期执行时间

</td></tr>
<tr style="mso-yfti-irow: 3" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


CommandType

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


CommandType

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


命令类型【Text | StoredProcedure | TableDirect 】

</td></tr>
<tr style="mso-yfti-irow: 4" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


Connection

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


string

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


database connection 的名称

</td></tr>
<tr style="mso-yfti-irow: 5" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


DesignTimeVisible

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


bool

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


在Windows Forms 界面中，这个Command object 是否可见。

</td></tr>
<tr style="mso-yfti-irow: 6" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


Parameters

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


SqlParameterCollection

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


Gets 命令的参数

</td></tr>
<tr style="mso-yfti-irow: 7" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


Transaction

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


SqlTransaction

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


database transaction for the command.

</td></tr>
<tr style="mso-yfti-irow: 8; mso-yfti-lastrow: yes" >

<td width="115" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: windowtext 1pt solid; WIDTH: 86.4pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


UpdatedRowSource

</td>

<td width="84" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 63pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


UpdateRowSource

</td>

<td width="720" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 540pt; PADDING-TOP: 0cm; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent; mso-border-alt: solid windowtext .5pt; mso-border-left-alt: solid windowtext .5pt; mso-border-top-alt: solid windowtext .5pt" valign="top" >


Gets or sets how the command results are to be applied to a DataRow object when the Update() method of a DataAdapter object is called.

</td></tr></tbody></table>


    2. 重要函数



      1. a 
<table style="MARGIN: auto auto auto 4.65pt; WIDTH: 424pt; mso-padding-alt: 0cm 5.4pt 0cm 5.4pt" rules="all" cellspacing="0" width="565" cellpadding="0" border="5" >
<tbody >
<tr style="HEIGHT: 31.5pt; mso-yfti-irow: 5; mso-yfti-firstrow: yes" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


**METHOD**

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


**RETURN TYPE**

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


**DESCRIPTION**

</td></tr>
<tr style="HEIGHT: 15.75pt; mso-yfti-irow: 1" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 15.75pt; BACKGROUND-COLOR: transparent" valign="top" >


Cancel()

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 15.75pt; BACKGROUND-COLOR: transparent" valign="top" >


void

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 15.75pt; BACKGROUND-COLOR: transparent" valign="top" >


取消执行命令

</td></tr>
<tr style="HEIGHT: 31.5pt; mso-yfti-irow: 2" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


CreateParameter()

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


SqlParameter

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


为命令建立新的参数

</td></tr>
<tr style="HEIGHT: 31.5pt; mso-yfti-irow: 3" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


ExecuteScalar()

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


object

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


执行 仅返回 单个值的 SQL SELECT 语句。

</td></tr>
<tr style="HEIGHT: 31.5pt; mso-yfti-irow: 4" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


ExecuteXmlReader()

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


XmlReader

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 31.5pt; BACKGROUND-COLOR: transparent" valign="top" >


执行 返回 XML 格式结果的 SQL SELECT 语句。

</td></tr>
<tr style="HEIGHT: 15.75pt; mso-yfti-irow: 5" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 15.75pt; BACKGROUND-COLOR: transparent" valign="top" >


Prepare()

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 15.75pt; BACKGROUND-COLOR: transparent" valign="top" >


void

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 15.75pt; BACKGROUND-COLOR: transparent" valign="top" >


</td></tr>
<tr style="HEIGHT: 21.85pt; mso-yfti-irow: 6; mso-yfti-lastrow: yes" >

<td width="169" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 126.85pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 21.85pt; BACKGROUND-COLOR: transparent" valign="top" >


ResetCommandTimeout()

</td>

<td width="88" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 66.15pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 21.85pt; BACKGROUND-COLOR: transparent" valign="top" >


void

</td>

<td width="308" style="BORDER-RIGHT: #ece9d8; PADDING-RIGHT: 5.4pt; BORDER-TOP: #ece9d8; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0cm; BORDER-LEFT: #ece9d8; WIDTH: 231pt; PADDING-TOP: 0cm; BORDER-BOTTOM: #ece9d8; HEIGHT: 21.85pt; BACKGROUND-COLOR: transparent" valign="top" >


</td></tr></tbody></table>


      2. 程序示例



        1. SqlCommand mySqlCommand = objConnection.CreateCommand();   
mySqlCommand.CommandText =   
"SELECT TOP 5 EmployeeID, NationalIDNumber, Title, MaritalStatus " +   
"FROM HumanResources.Employee " +   
"ORDER BY EmployeeID";   
objConnection.Open();  
SqlDataReader mySqlDataReader = mySqlCommand.ExecuteReader();  
while (mySqlDataReader.Read())  
{   
Console.WriteLine("mySqlDataReader[\"EmployeeID\"] = " + mySqlDataReader["EmployeeID"]);   
Console.WriteLine("mySqlDataReader[\"NationalIDNumber\"] = " + mySqlDataReader["NationalIDNumber"]);   
Console.WriteLine("mySqlDataReader[\"Title\"] = " + mySqlDataReader["Title"]);  
Console.WriteLine("mySqlDataReader[\"MaritalStatus\"] = " + mySqlDataReader["MaritalStatus"]);


        2. 例子解释



          1. CreateCommand(); 函数来创建一个 SqlCommand 对象


          2. CommandText 是要执行的 sql 命令，或者存储进程，


          3. ExecuteReader();是在执行了 CommandText 中的命令后，返回的结果。


          4. 在填写表名时，注意要把schema名也写上，例如“HumanResources.”


          5. mySqlDataReader.Read()是返回一个bool值，如果还有未读取的行，则true；否则为false


          6. mySqlDataReader["EmployeeID"]中，以“[""]”括起对应的column名称，以get这个对应值


      3. DataTable Schema



        1. 如何访问 schema


        2. schema 值意义，参见 Table 1([http://xl2.blog.163.com/blog/static/17226383200801551057234](http://xl2.blog.163.com/blog/static/17226383200801551057234))


      4. 使用 XML Reader



        1. 代码实例



          1. mySqlCommand.CommandText =   
"SELECT TOP 5 EmployeeID, NationalIDNumber, Title, MaritalStatus " +   
"FROM HumanResources.Employee " +   
"ORDER BY EmployeeID " +  
"FOR XML AUTO";  
objConnection.Open();    
XmlReader myXmlReader = mySqlCommand.ExecuteXmlReader();  
myXmlReader.Read();   
while (!myXmlReader.EOF)   
{   
Console.WriteLine(myXmlReader.ReadOuterXml());   
}


          2. 代码解释



            1. 必须在 CommandText 加入 XML 语句，以使得返回结果符合 XML 格式（例如"FOR XML AUTO"）


            2. ExecuteXmlReader用以返回一个 XML Reader


            3. EOF用来检查是否还有未读取的 XML 数据


            4. ReadOuterXml 用来读取一行 XML 数据


      5. 要执行 Insert，Delete，Create，Alter 等命令，应该调用 ExecuteNonQuery() 函数。


      6. 使用 transaction



        1. 代码实例



          1. mySqlConnection.Open();  
SqlCommand mySqlCommand = mySqlConnection.CreateCommand();  
SqlTransaction mySqlTransaction = mySqlConnection.BeginTransaction();  
mySqlCommand.Transaction = mySqlTransaction;  
mySqlCommand.CommandText = ...  
mySqlCommand.ExecuteNonQuery();  
mySqlCommand.CommandText = ...  
mySqlCommand.ExecuteNonQuery();  
mySqlTransaction.Commit();  
//mySqlTransaction.Rollback();


        2. 代码解释



          1. 要调用 Connection 对象的 BeginTransaction() 函数来建立一个 Transaction 对象


          2. 把新建立的 Transaction 对象 传递给 SqlCommand 对象


          3. 执行多次不同的 CommandText，每次执行后要调用 ExecuteNonQuery();函数


          4. 调用 Transaction 对象 的 Commit();或者 Rollback();函数来确认、取消这些操作。


      7. 给 Command 补充参数



        1. 用途： 当要多次执行同一命令，而只是参数不同的时候。例如，要 insert 很多行，只是每行的内容不同。就可以 1）先指定命令中那些部分是参数，2）然后补充参数类型，3）补充参数值，4）执行命令


        2. 步骤一：指定命令中的参数



          1. 代码实例



            1. mySqlCommand.CommandText = "INSERT INTO Customers (" + " CustomerID, CompanyName, ContactName" + ") VALUES (" + " @CustomerID, @CompanyName, @ContactName" + ")";


          2. 说明： 在代码中，命令文本中有“@”符号的就是参数。在上面例子中，总共有3个参数。


        3. 步骤二：补充参数类型



          1. 代码实例



            1. mySqlCommand.Parameters.Add("@CustomerID", SqlDbType.NChar, 5);  
mySqlCommand.Parameters.Add("@CompanyName", SqlDbType.NVarChar, 40);  
mySqlCommand.Parameters.Add("@ContactName", SqlDbType.NVarChar, 30);


          2. 说明： 



            1. 每个 Command 对象包含着一个 SqlParameterCollection 对象，所有的 参数 会被添加到这个集合中。上例中就是调用了 这个集合类的 Add（）函数。


            2. Add（）函数有不同的 overload 版本，以便添加不同的类型参数。上例中，Add("@CustomerID", SqlDbType.NChar, 5) 中的 @CustomerID 是 SqlCommand 中的参数名，SqlDbType.NChar 是指定该参数在数据库中的类型，5 是指定该参数在数据库中的最大值。


        4. 步骤三：补充参数值



          1. 代码实例



            1. mySqlCommand.Parameters["@CustomerID"].Value = "J4COM";  
mySqlCommand.Parameters["@CompanyName"].Value = "J4 Company";  
mySqlCommand.Parameters["@ContactName"].Value = "Jason Price";


          2. 说明： 



            1. 以上代码为命令的3个参数分别 添加了 一个值。


            2. 如果要将参数值 设为 null 值，可以做以下两步：



              1. mySqlCommand.Parameters["@ContactName"].IsNullable = true; // _指明该参数可以为 null_


              2. mySqlCommand.Parameters["@ContactName"].Value = DbNull.Value; // _设置参数值 为 null_


        5. 步骤四：调用 Execute 函数去执行 Command
